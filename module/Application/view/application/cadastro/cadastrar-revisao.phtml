<?php

use Application\Controller\Helper\Constantes;
$form = $this->revisaoForm;
$form->prepare();
$form->setAttribute(Constantes::$ACTION, $this->url(Constantes::$ROUTE_CADASTRO, array(Constantes::$PAGINA => Constantes::$PAGINA_SALVAR_REVISAO)));
echo $this->formHidden($form->get(Constantes::$FORM_ID));
?>
<div class="mw1000 center-block">
    <div class="admin-form theme-primary">
        <div class="panel-body bg-light">
            <!-- Estado Civil -->


            <?php echo $this->form()->openTag($form); ?> 
            <!-- Incluir Responsavel -->
            <div id="divIncluirDados" class="">
                <!-- Passo a Passo -->
                <div id="divPassoAPasso" class=""> 
                    <div id="passos"  class="stepwizard">
                        <div class="stepwizard-row">
                            <div id="1"  class="stepwizard-step stepwizard-step-cadastro-grupo">
                                <button id="botaoPasso1" type="button" class="btn btn-primary btn-circle" disabled="disabled">1</button>
                                <p>Data</p> 
                            </div>


                            <div id="2"  class="stepwizard-step stepwizard-step-cadastro-grupo">
                                <button id="botaoPasso2" type="button" class="btn btn-default btn-circle" disabled="disabled">2</button>
                                <p>Igrejas</p>
                            </div>
                            <div id="3"  class="stepwizard-step stepwizard-step-cadastro-grupo">
                                <button id="botaoPasso3" type="button" class="btn btn-default btn-circle" disabled="disabled">3</button>
                                <p>Observação</p>
                            </div>
                            <div id="4"  class="stepwizard-step stepwizard-step-cadastro-grupo">
                                <button id="botaoPasso4" type="button" class="btn btn-default btn-circle" disabled="disabled">4</button>
                                <p>Confirme</p>
                            </div>
                        </div>
                    </div>            <!-- HelperView Dados -->
                    <div id="divDadosEmcima" class="alert alert-info hidden">
                        <div id="divSpanDataRevisao"  class="quebraDeLinhaDeSpan">
                            <i class="fa fa-info-circle" aria-hidden="true"></i>&nbsp;
                            <span id="spanDataRevisao"></span>
                        </div>
                        <div id="divSpanIgrejas"  class="quebraDeLinhaDeSpan">
                            <i class="fa fa-user" aria-hidden="true"></i>&nbsp;
                            <span id="spanIgrejas"></span>
                        </div>

                    </div>
                    <!-- Fim HelperView -->
                    <span id="spanMensagens" class="quebraDeLinhaDeSpan mt10 alert text-center hidden"></span>
                </div>

                <!-- Selecionar Aluno -->
                <div id="divData" class="">
                    <div class="section-divider mt40">
                        <span>Qual a data do Revisão?</span>
                    </div> 
                    <div class="panel-menu">
                        <?php echo $this->formInput($form->get(Constantes::$FORM_INPUT_DATA_REVISAO)); ?>
                    </div>
                    <!-- Tabela de Alunos -->
                    <div id="divBotaoDataRevisao" class="">
                        <button type="button" onClick='botaoProsseguirIgrejas();' style="float: right;" onclick='location.href = "#";' 
                                class="btn ladda-button btn-primary  mr10" data-style="zoom-in">
                            <span class="ladda-label">Continuar</span>
                        </button>
                    </div>

                </div>
                <div id="divIgrejas" class="hidden">
                    <div class="section-divider mt40">
                        <span id="spanInserirIgrejas"> </span>
                    </div> 
                    <div class="panel-menu">
                        <?php echo $this->formMultiCheckBox($form->get('igrejas')); ?>
                    </div>
                    <!-- Tabela de Alunos -->
                    <div id="divBotaoIgrejas" class="">
                        <button type="button" onClick='botaoProsseguirObservacao();' style="float: right;" onclick='location.href = "#";'
                                class="btn ladda-button btn-primary  mr10" data-style="zoom-in">
                            <span class="ladda-label">Continuar</span>
                        </button>
                    </div>
                    <button type="button" onClick='botaoVoltarData();' style="float: right;" onclick='location.href = "#";'
                            class="btn ladda-button btn-default dark  mr10" data-style="zoom-in">
                        <span class="ladda-label">Voltar</span>
                    </button>            
                </div>
                <div id="divObservacao" class="hidden">
                    <div class="section-divider mt40">
                        <span id="spanInserirObservacao"> Qual nome do Revisao? </span>
                    </div> 
                    <div class="panel-menu">
                        <?php echo $this->formInput($form->get('nome')); ?>
                    </div>
                    <!-- Tabela de Alunos -->
                    <div id="divBotaoIgrejas" class="">
                        <button type="button" onClick='botaoProsseguirConfirmacao();' style="float: right;" onclick='location.href = "#";'
                                class="btn ladda-button btn-primary  mr10" data-style="zoom-in">
                            <span class="ladda-label">Continuar</span>
                        </button>
                    </div>
                    <button type="button" onClick='botaoVoltarIgrejas();' style="float: right;" onclick='location.href = "#";'
                            class="btn ladda-button btn-default dark  mr10" data-style="zoom-in">
                        <span class="ladda-label">Voltar</span>
                    </button>            
                </div>
                <div id="divConfirmacao" class="hidden">
                    <div class="section-divider mt40">
                        <span>Confirme os dados</span>
                    </div> 

                    <!-- Tabela de Alunos -->
                    <div id="divBotaoConfirmacao" class="">
                        <button type="button" onClick='preValidacao();' style="float: right;" onclick='location.href = "#";'
                                class="btn ladda-button btn-primary  mr10" data-style="zoom-in">
                            <span class="ladda-label">Cadastrar</span>
                        </button>
                    </div>
                    <button type="button" onClick='botaoVoltarObservacao();' style="float: right;" onclick='location.href = "#";'
                            class="btn ladda-button btn-default dark  mr10" data-style="zoom-in">
                        <span class="ladda-label">Voltar</span>
                    </button>            
                </div>
            </div>

        </div>

    </div>
    <?php echo $this->form()->closeTag(); ?>
<script type="text/javascript">
                        /**
                         * Nome: layout-js-grupo-validacao.js
                         * @author Leonardo Pereira Magalhães <falecomleonardopereira@gmail.com>
                         * Descricao: Funções para cadastro de um novo grupo
                         */

                        /* Dados */
                        var estadoCivil = 0;
                        var iconeTime = '<i class="fa fa-times" aria-hidden="true"></i>';
                        var iconeCheck = '<i class="fa fa-check" aria-hidden="true"></i>';
                        var hidden = 'hidden';
                        var textDanger = 'text-danger';
                        var textSuccess = 'text-success';
                        var stringNBSP = '&nbsp;';
                        var alertDanger = 'alert-danger';
                        var alertSuccess = 'alert-success';
                        var btnDefault = 'btn-default';
                        var btnPrimary = 'btn-primary';







                        function botaoVoltarData() {
                            $('#spanMensagens').addClass(hidden);
                            $('#botaoPasso2').removeClass(btnPrimary);
                            $('#botaoPasso2').addClass(btnDefault);
                            $('#botaoPasso1').removeClass(btnDefault);
                            $('#botaoPasso1').addClass(btnPrimary);
                            $('#divData').removeClass(hidden);
                            $('#divIgrejas').addClass(hidden);
                        }
                        function botaoVoltarIgrejas() {
                            $('#botaoPasso3').removeClass(btnPrimary);
                            $('#botaoPasso3').addClass(btnDefault);  
                            $('#botaoPasso2').removeClass(btnDefault);
                            $('#botaoPasso2').addClass(btnPrimary);
                            $('#divConfirmacao').addClass(hidden);
                            $('#divIgrejas').removeClass(hidden);
                            $('#divDadosEmcima').addClass(hidden);
                            $('#divObservacao').addClass(hidden);
                        }
                        function botaoVoltarObservacao() {
                            $('#botaoPasso4').removeClass(btnPrimary);
                            $('#botaoPasso4').addClass(btnDefault);  
                            $('#botaoPasso3').removeClass(btnDefault);
                            $('#botaoPasso3').addClass(btnPrimary);
                            $('#divConfirmacao').addClass(hidden);
                            $('#divIgrejas').addClass(hidden);
                            $('#divDadosEmcima').addClass(hidden);
                            $('#divObservacao').removeClass(hidden);
                        }
                        function botaoProsseguirIgrejas() {
                            valorData = $('#dataRevisao').val();
                            var spanMensagens = $('#spanMensagens');
                            if (valorData.length == 0) {

                                spanMensagens.text('Please Insert Date');
                                spanMensagens
                                        .addClass(alertDanger)
                                        .removeClass(hidden);
                            } else {
                                $('#spanMensagens').addClass(hidden);
                                $('#botaoPasso1').removeClass(btnPrimary);
                                $('#botaoPasso1').addClass(btnDefault);
                                $('#botaoPasso2').removeClass(btnDefault);
                                $('#botaoPasso2').addClass(btnPrimary);
                                $('#divData').addClass(hidden);
                                $('#divIgrejas').removeClass(hidden);
                                data = 'Quais Igrejas Participaram do Evento na sexta dia ' + $('#dataRevisao').val();
                                $('#spanInserirIgrejas').html(data);
                            }
                        }
                        function botaoProsseguirObservacao() {
                            if ($("input:checked").length == 0) {

                                var spanMensagens = $('#spanMensagens');
                                spanMensagens.text('Please Select One Church');
                                spanMensagens
                                        .addClass(alertDanger)
                                        .removeClass(hidden);

                            } else {
                                $('#spanMensagens').addClass(hidden);
                                $('#botaoPasso2').removeClass(btnPrimary);
                                $('#botaoPasso2').addClass(btnDefault);
                                $('#botaoPasso3').removeClass(btnDefault);
                                $('#botaoPasso3').addClass(btnPrimary);
                                $('#divIgrejas').addClass(hidden);
                                $('#divObservacao').removeClass(hidden);
                                data = 'Quais Igrejas Participaram do Evento na sexta dia ' + $('#dataRevisao').val();
                                $('#spanInserirIgrejas').html(data);
                            }
                        }
                        
                        function botaoProsseguirConfirmacao() {

                            if ($("input:checked").length == 0) {

                                var spanMensagens = $('#spanMensagens');
                                spanMensagens.text('Please Select One Church');
                                spanMensagens
                                        .addClass(alertDanger)
                                        .removeClass(hidden);
                            } else {
                                var nomeIgrejasSelecionadas = 'Igrejas: ';
                                var todosElementos = document.revisaoForm.elements;
                                for (i = 0; i < todosElementos.length; i++) {
                                    if (todosElementos[i].type == "checkbox" && todosElementos[i].checked) {
                                        var valorIgrejas = todosElementos[i].value;
                                        var splitIgrejas = valorIgrejas.split("#");
                                        nomeIgrejasSelecionadas += '<br />' + splitIgrejas[0];
                                    }
                                }
                                $('#spanMensagens').addClass(hidden);
                                $('#botaoPasso3').removeClass(btnPrimary);
                                $('#botaoPasso3').addClass(btnDefault);
                                $('#botaoPasso4').removeClass(btnDefault);
                                $('#botaoPasso4').addClass(btnPrimary);
                                $('#divObservacao').addClass(hidden);
                                $('#divConfirmacao').removeClass(hidden);
                                dataRevisao = 'Data do Revisão ' + $('#dataRevisao').val();

                                $('#divDadosEmcima').removeClass(hidden);
                                $('#spanDataRevisao').html(dataRevisao);
                                $('#spanIgrejas').html(nomeIgrejasSelecionadas);
                            }
                        }

                        function preValidacao() {
//                            var validator;
//                            validator = $('#revisaoForm').validate();
//                            if (validator.form()) {
                            $('#revisaoForm').submit();
//                            }
                        }

                        window.onload = initPage;

                        function initPage() {

                            var today = new Date();
                            var dd = today.getDate();
                            var mmVigente = today.getMonth();
                            var mm = today.getMonth(); //January is 0!
                            var yyyy = today.getFullYear();
                            var labelDays = dd - 1;
                            if (mmVigente != mm) {
                                if (mmVigente == 0) {
                                    yyyy = yyyy - 1;
                                }
                            }
                            function DisableDays(date) {
                                var day = date.getDay();
                                // If day == 1 then it is MOnday
                                if (day != 5) {

                                    return [false];

                                } else {

                                    return [true];
                                }

                            }
                            if ($('#dataRevisao').prop('type') != 'date') {
                                var dataMinima;
                                var dataMaxima;
                                if (mmVigente != mm) {
                                    dataMinima = new Date(yyyy, mm, 1);
                                    dataMaxima = new Date(yyyy, mm, 31);
                                } else {
                                    dataMinima = '-' + labelDays;
                                    dataMaxima = 0;
                                }
                                $('#dataRevisao').datepicker({
                                    dateFormat: 'dd/mm/yy',
                                    enableDays: [5],
                                    minDate: dataMaxima,
                                    beforeShowDay: DisableDays,
                                });
                            } else {
                                var mmTrabalhado;
                                var firstDay;
                                mmTrabalhado = mm + 1;
                                if (dd < 10) {
                                    dd = '0' + dd
                                }
                                if (mmTrabalhado < 10) {
                                    mmTrabalhado = '0' + mmTrabalhado
                                }

                                if (mmVigente != mm) {
                                    today = yyyy + '-' + mmTrabalhado + '-31';
                                } else {
                                    today = yyyy + '-' + mmTrabalhado + '-' + dd;
                                }
                                firstDay = yyyy + '-' + mmTrabalhado + '-01';

                                $('#dataRevisao').attr('min', today);
                            }

                            function isMobile() {
                                var check = false;
                                (function (a) {
                                    if (/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0, 4)))
                                        check = true;
                                })(navigator.userAgent || navigator.vendor || window.opera);
                                return check;
                            }
                            ;

//                             
//                            $.validator.addMethod(
//                                    "date",
//                                    function (value, element) {
//                                        var check = false;
//                                        if (isMobile()) {
//                                            var re = /^\d{4}-\d{1,2}-\d{1,2}$/;
//                                            if (re.test(value)) {
//                                                var adata1 = value.split('-');
//                                                var gg1 = parseInt(adata1[2], 10);
//                                                var mm1 = parseInt(adata1[1], 10);
//                                                var aaaa1 = parseInt(adata1[0], 10);
//                                                var xdata1 = new Date(aaaa1, mm1 - 1, gg1);
//                                                if ((xdata1.getFullYear() == aaaa1) && (xdata1.getMonth() == mm1 - 1) && (xdata1.getDate() == gg1))
//                                                    check = true;
//                                                else
//                                                    check = false;
//                                            } else
//                                                check = false;
//                                        } else {
//                                            var re = /^\d{1,2}\/\d{1,2}\/\d{4}$/;
//                                            if (re.test(value)) {
//                                                var adata = value.split('/');
//                                                var gg = parseInt(adata[0], 10);
//                                                var mm = parseInt(adata[1], 10);
//                                                var aaaa = parseInt(adata[2], 10);
//                                                var xdata = new Date(aaaa, mm - 1, gg);
//                                                if ((xdata.getFullYear() == aaaa) && (xdata.getMonth() == mm - 1) && (xdata.getDate() == gg))
//                                                    check = true;
//                                                else
//                                                    check = false;
//                                            } else
//                                                check = false;
//                                        }
//
//                                        return this.optional(element) || check;
//                                    },
//                                    "Insert Valid Date"
//                                    );
//
//                            $('#RevisaoForm').validate({
//                                /* @validation states + elements 
//                                 ------------------------------------------- */
//                                focusInvalid: false,
//                                errorClass: "state-error",
//                                validClass: "state-success",
//                                errorElement: "em",
//                                /* @validation rules 
//                                 ------------------------------------------ */
//
//                                rules: {
//                                    dataRevisao: {
//                                        required: true,
//                                        date: true,
//                                        maxlength: 10,
//                                        minlength: 10,
//                                    },
//                                    'igrejas[]': {
//                                        required: true
//                                    }
//                                },
//                                /* @validation error messages 
//                                 ---------------------------------------------- */
//
//                                messages: {
//                                    dataRevisao: {
//                                        required: 'Insert Date',
//                                        maxlength: 'Please enter a valid date. Max: 10 characters',
//                                        minlength: 'Please enter a valid date. Min: 10 characters'
//                                    },
//                                    'igrejas[]': {
//                                        required: 'Select Church'
//                                    }
//                                },
//                                /* @validation highlighting + error placement  
//                                 ---------------------------------------------------- */
//
//                                highlight: function (element, errorClass, validClass) {
//                                    $(element).closest('.field').addClass(errorClass).removeClass(validClass);
//                                },
//                                unhighlight: function (element, errorClass, validClass) {
//                                    $(element).closest('.field').removeClass(errorClass).addClass(validClass);
//                                },
//                                errorPlacement: function (error, element) {
//                                    if (element.is(":radio") || element.is(":checkbox")) {
//                                        element.closest('.option-group').after(error);
//                                    } else {
//                                        error.insertAfter(element.parent());
//                                    }
//                                }
//
//
//                            });
                        }
                        ;



</script> 

